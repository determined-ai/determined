syntax = "proto3";

package determined.api.v2;
option go_package = "github.com/determined-ai/determined/proto/pkg/apiv2";

import "google/protobuf/wrappers.proto";
import "google/protobuf/struct.proto";
import "google/protobuf/timestamp.proto";
import "protoc-gen-swagger/options/annotations.proto";

import "determined/job/v2/job.proto";
import "determined/search/v2/search.proto";

// Get a single search.
message GetSearchRequest {
  // The id of the search.
  int32 search_id = 1;
}
// Response to GetSearchRequest.
message GetSearchResponse {
  option (grpc.gateway.protoc_gen_swagger.options.openapiv2_schema) = {
    json_schema: { required: [ "search" ] }
  };
  // The requested search.
  determined.search.v2.Search search = 1;
  // Associated job summary.
  determined.job.v2.JobSummary job_summary = 2;
  // The search's config.
  google.protobuf.Struct config = 3;
}

// Get a list of search tags.
message GetSearchTagsRequest {
  // Filter searches by project.
  int32 project_id = 1;
}

// Response to GetSearchTagsRequest
message GetSearchTagsResponse {
  // The list of tags used across all searches.
  repeated string tags = 1;
}

// Request for adding a new search tag.
message PutSearchTagRequest {
  option (grpc.gateway.protoc_gen_swagger.options.openapiv2_schema) = {
    json_schema: { required: [ "search_id", "tag" ] }
  };

  // The ID of the search.
  int32 search_id = 1;

  // The tag to add.
  string tag = 2;
}

// Response to PutSearchTagRequest.
message PutSearchTagResponse {
  option (grpc.gateway.protoc_gen_swagger.options.openapiv2_schema) = {
    json_schema: { required: [ "tags" ] }
  };

  // The complete list of tags associated with the search.
  repeated string tags = 1;
}

// Request for deleting an search tag.
message DeleteSearchTagRequest {
  option (grpc.gateway.protoc_gen_swagger.options.openapiv2_schema) = {
    json_schema: { required: [ "search_id", "tag" ] }
  };

  // The ID of the search.
  int32 search_id = 1;

  // The tag to delete.
  string tag = 2;
}

// Response to DeleteSearchTagRequest.
message DeleteSearchTagResponse {
  option (grpc.gateway.protoc_gen_swagger.options.openapiv2_schema) = {
    json_schema: { required: [ "tags" ] }
  };

  // The complete list of tags associated with the search.
  repeated string tags = 1;
}
