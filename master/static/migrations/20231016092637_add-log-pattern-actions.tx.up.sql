CREATE TABLE log_policy_retry_on_different_node (
  id             integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  task_id        text NOT NULL,
  node_name      text NOT NULL,
  regex          text NOT NULL,
  triggering_log text NOT NULL,
  task_ended     bool NOT NULL DEFAULT FALSE,
  CONSTRAINT unique_retry_on_different_node UNIQUE (task_id, node_name, regex)
);
CREATE INDEX idx_log_policy_retry_on_different_node_task_id ON
  log_policy_retry_on_different_node(task_id, task_ended);

CREATE TABLE log_policy_dont_retry (
  id             integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  task_id        text NOT NULL,
  node_name      text NOT NULL,
  regex          text NOT NULL,
  triggering_log text NOT NULL,
  CONSTRAINT unique_policy_dont_retry UNIQUE (task_id, regex)
);
CREATE INDEX idx_log_policy_dont_retry_task_id ON
  log_policy_dont_retry(task_id);
