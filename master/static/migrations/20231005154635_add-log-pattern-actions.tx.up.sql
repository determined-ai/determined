CREATE TABLE log_policy_retry_on_different_node (
  id             integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  task_id        text NOT NULL, -- TODO index
  node_name      text NOT NULL,
  regex          text NOT NULL,
  triggering_log text NOT NULL
);

CREATE INDEX idx_log_policy_retry_on_different_node_task_id ON
  log_policy_retry_on_different_node(task_id);

CREATE TABLE log_policy_dont_retry (
  id             integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  task_id        text NOT NULL, -- TODO index
  node_name      text NOT NULL,
  regex          text NOT NULL,
  triggering_log text NOT NULL
);

CREATE INDEX idx_log_policy_dont_retry_task_id ON
  log_policy_dont_retry(task_id);

CREATE TABLE log_policy_send_webhook (
  id             integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  task_id        text NOT NULL, -- TODO index
  node_name      text NOT NULL,
  regex          text NOT NULL,
  triggering_log text NOT NULL
);

CREATE INDEX idx_log_policy_send_webhook_task_id ON
  log_policy_send_webhook(task_id);
