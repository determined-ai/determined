"""
This example is to show how to use an existing Tensorflow Image Segmentation model with Determined.
The flags and configurations can be found under const.yaml. For more information
regarding the optional flags view the original script linked below.
This implementation is based on:
https://github.com/tensorflow/docs/blob/master/site/en/tutorials/images/segmentation.ipynb
"""
description: unets_tf_keras_const
data:
  train_url: http://download.tensorflow.org/data/iris_training.csv 
  test_url: http://download.tensorflow.org/data/iris_test.csv
  BUFFER_SIZE: 1000

hyperparameters:
  learning_rate: 1e-4
  learning_rate_decay: 1e-6
  layer1_dense_size: 16
  global_batch_size: 64
  OUTPUT_CHANNELS: 3

searcher:
  name: single
  metric: val_accuracy
  smaller_is_better: false
  max_steps: 230 # There are ~7400 examples (200 examples/class * 37 classes) in the training set
                   # We run for 20 epochs as per the Tensorflow UNet tutorial. We get 230 by:
                   # 7400 / global_batch_size / (1 batch per step) * 20 epochs

min_validation_period: 10
entrypoint: model_def:UNetsTrial
