name: ffn_example_ds_launcher_dsat
workspace: DS_AT_PROTOTYPING
project: ffn_example
max_restarts: 0
environment:
  image:
    gpu: determinedai/environments:cuda-11.3-pytorch-1.10-deepspeed-0.8.3-gpu-0.21.2
resources:
  slots_per_trial: 2
  shm_size: 17179869184 # 16 GiB. Was hitting "Unexpected bus error encountered in worker. This might be caused by insufficient shared memory (shm)."
  max_slots: 8
  # resource_pool: young # Grenoble specific; remove later.
searcher:
  name: single
  max_length: 1000
  metric: loss
  smaller_is_better: False
hyperparameters:
  dim: 4096
  layers: 3 # Total params will be layers * dim ** 2
  deepspeed_config: ds_config.json
entrypoint: python3 -m determined.launch.deepspeed python3 script.py
