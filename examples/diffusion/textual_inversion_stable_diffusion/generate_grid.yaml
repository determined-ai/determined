# A grid search over multiple prompts and pipeline settings
name: detsd_generate
entrypoint: python3 -m determined.launch.torch_distributed python3 generate.py
searcher:
  name: grid
  metric: none
  max_length: 16 # Number of times the generation pipeline is called, per-worker.
resources:
  slots_per_trial: 2
max_restarts: 0
environment:
    environment_variables:
        - HF_AUTH_TOKEN=YOUR_HF_AUTH_TOKEN_HERE
hyperparameters:
    pipeline: # The `device` arg is handled by the generate_on_cluster method; do not specify.
        learned_embeddings_filename: learned_embeddings_dict.pt
        scheduler_name: pndm
        beta_start: 0.00085
        beta_end: 0.012
        beta_schedule: scaled_linear
        other_scheduler_kwargs: {}
        pretrained_model_name_or_path: CompVis/stable-diffusion-v1-4
        use_fp16: True
    uuids: []
    call:
      prompt:
        type: categorical
        vals:
          - a Van Gogh painting of a <det-logo>
          - a <det-logo> in outer space
      num_samples: 2
      batch_size: 2
      num_inference_steps: 50
      guidance_scale:
        type: double
        minval: 5.
        maxval: 20.
        count: 4
      other_hf_pipeline_call_kwargs: {}
      max_nsfw_retries: 10
    main_process_seed: 2147483647 # Various seeds are scanned during generation; don't scan over seed in an HP search.
    save_freq: 4

